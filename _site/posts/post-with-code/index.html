<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jonathan Jelliff">
<meta name="dcterms.date" content="2023-12-06">

<title>Advanded Data Analytics and Data Science - Post With Code</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Advanded Data Analytics and Data Science</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">Jonathan Jelliff</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kairos7139/primary" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/jonathan-jelliff/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../kairos7139@gmail.com" rel="" target=""><i class="bi bi-gMail" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Post With Code</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">news</div>
                <div class="quarto-category">code</div>
                <div class="quarto-category">analysis</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Jonathan Jelliff </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 6, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>This is a post a representing Ordinary Least Squares Linear Regression Model using polynomial regression, local regression, step functions, and both regression and smoothing splines.</p>
<p>This was chose due to the level of complexity to showcase a Business Problem of North Carolina’s 2004 birth records data, and the analysis of a correlation between the routines and behaviors of pregnant mothers and childbirth outcomes. Numerous factors were measures such as the father and mother’s age, maturity status of the mother, length of pregnancy, classification of a premature birth, # of visits during the pregnancy, marital status, weight stability of mother during pregnancy, gender of the baby, smoking habit of mother, and race of the mother. This was a total of 13 variables. The target variable in the analysis is the weight outcome of the baby during birth.</p>
<p>The study was taken with a total of 1,000 inputs in which all data was gained in North Carolina. Observation with missing data were ommitted from the study- which totalled less than 10%.</p>
<p>The data was prepared and split into 70% training data, and 30% testing data. Furthermore, a correlation analysis and visualization were done in order to determine the variable which had the highest absolute value to the target variable, in this case the child’s weight at birth. The variable with the highest correlation was the number of maternity weeks compared to the weight of the infant- which can be seen in the scatter plot demonstrated below. Generally, when maternity weeks were below 27 the weight of the baby was fairly constant at below 3lbs, but entering into the 30th maternity week, the average fetus weight seemed to hit a growth spurt gaining much of its weight up to week 37 in which it plateaus again leading to the constant weight up until birth.</p>
<p>During the analysis the hypothesis was nullified that the mother’s age had any significant correlation to the child’s weight at birth. The father’s weight was compared as well- leading to the same conclusion.</p>
<p>The training data was further analyzed in a leaner model in predicting weights compared to weeks of pregnancy as seen below.</p>
<p>The overall coefficients are as follows.</p>
<pre><code>##              Estimate Std. Error t value Pr(&gt;|t|)     ## (Intercept) -7.069515   0.581129 -12.165  &lt; 2e-16 *** ## fage         0.014971   0.009724   1.540  0.12413     ## mage         0.010142   0.009666   1.049  0.29445     ## weeks        0.339776   0.014522  23.397  &lt; 2e-16 *** ## visits       0.012027   0.010808   1.113  0.26622     ## gained       0.008512   0.003048   2.793  0.00537 **</code></pre>
<p>This data shows that only weeks of pregnancy and weight gained by the mother had a statistically significant impact unto the child’s birth weight. As shows by a P-value of 2e-16, and .00537, which is of very high significance- especially in the case of weeks of pregnancy. The remaining variables represented a P-value above 0.05 with the mother’s age being the least significant.</p>
<p>Overall, I would conclude that the data is sound in suitability for testing, with a small amount of limitations. The most significant limitation though, being that the data were all collected within a concentrated area of the country, in that it was only collected in North Carolina. That being considered, other factors could be of significance that were overlooked such as locally economic, environmental, and health accessibility factors that were only pertinent to the North Carolina area. More study would need to be done at a broader region in order to determine if these hypothesis are valid nationwide.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.4.4     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rsample)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice

Attaching package: 'caret'

The following object is masked from 'package:purrr':

    lift</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: nlme

Attaching package: 'nlme'

The following object is masked from 'package:dplyr':

    collapse

This is mgcv 1.9-0. For overview type 'help("mgcv-package")'.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(finalfit)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Run this code chunk without altering it</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># clear the session</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Data is stored in a csv file, the first row contains the variable names. </span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># we call our data mydata</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>mydata<span class="ot">&lt;-</span><span class="fu">read.csv</span> (<span class="st">"Data_RLab5.csv"</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># remove lowbirthweight</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>mydata<span class="ot">&lt;-</span>mydata<span class="sc">%&gt;%</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>lowbirthweight)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Please provide your code for Task 1 in this code chunk</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Please provide your code for Task 1 in this code chunk</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dygraphs)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: zoo

Attaching package: 'zoo'

The following objects are masked from 'package:base':

    as.Date, as.Date.numeric


######################### Warning from 'xts' package ##########################
#                                                                             #
# The dplyr lag() function breaks how base R's lag() function is supposed to  #
# work, which breaks lag(my_xts). Calls to lag(my_xts) that you type or       #
# source() into this session won't work correctly.                            #
#                                                                             #
# Use stats::lag() to make sure you're not using dplyr::lag(), or you can add #
# conflictRules('dplyr', exclude = 'lag') to your .Rprofile to stop           #
# dplyr from breaking base R's lag() function.                                #
#                                                                             #
# Code in packages is not affected. It's protected by R's namespace mechanism #
# Set `options(xts.warn_dplyr_breaks_lag = FALSE)` to suppress this warning.  #
#                                                                             #
###############################################################################

Attaching package: 'xts'

The following objects are masked from 'package:dplyr':

    first, last</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SmartEDA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verifying data sctructure and any missing values</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ExpData</span>(<span class="at">data=</span>mydata,<span class="at">type=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                          Descriptions   Value
1                                   Sample size (nrow)     999
2                              No. of variables (ncol)      12
3                    No. of numeric/interger variables       6
4                              No. of factor variables       0
5                                No. of text variables       6
6                             No. of logical variables       0
7                          No. of identifier variables       0
8                                No. of date variables       0
9             No. of zero variance variables (uniform)       0
10               %. of variables having complete cases 50% (6)
11   %. of variables having &gt;0% and &lt;50% missing cases 50% (6)
12 %. of variables having &gt;=50% and &lt;90% missing cases  0% (0)
13          %. of variables having &gt;=90% missing cases  0% (0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ExpData</span>(<span class="at">data=</span>mydata,<span class="at">type=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Index Variable_Name Variable_Type Sample_n Missing_Count Per_of_Missing
1      1          fage       integer      829           170          0.170
2      2          mage       integer      999             0          0.000
3      3        mature     character      999             0          0.000
4      4         weeks       integer      998             1          0.001
5      5        premie     character      998             1          0.001
6      6        visits       integer      991             8          0.008
7      7       marital     character      999             0          0.000
8      8        gained       integer      973            26          0.026
9      9        weight       numeric      999             0          0.000
10    10        gender     character      999             0          0.000
11    11         habit     character      999             0          0.000
12    12      whitemom     character      997             2          0.002
   No_of_distinct_values
1                     37
2                     33
3                      2
4                     23
5                      3
6                     26
7                      2
8                     71
9                    126
10                     2
11                     2
12                     3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mydata)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ff_glimpse</span>(mydata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Continuous
        label var_type   n missing_n missing_percent mean   sd  min quartile_25
fage     fage    &lt;int&gt; 829       170            17.0 30.3  6.8 14.0        25.0
mage     mage    &lt;int&gt; 999         0             0.0 27.0  6.2 13.0        22.0
weeks   weeks    &lt;int&gt; 998         1             0.1 38.3  2.9 20.0        37.0
visits visits    &lt;int&gt; 991         8             0.8 12.1  4.0  0.0        10.0
gained gained    &lt;int&gt; 973        26             2.6 30.3 14.2  0.0        20.0
weight weight    &lt;dbl&gt; 999         0             0.0  7.1  1.5  1.0         6.4
       median quartile_75  max
fage     30.0        35.0 55.0
mage     27.0        32.0 50.0
weeks    39.0        40.0 45.0
visits   12.0        15.0 30.0
gained   30.0        38.0 85.0
weight    7.3         8.1 11.8

$Categorical
            label var_type   n missing_n missing_percent levels_n levels
mature     mature    &lt;chr&gt; 999         0             0.0        2      -
premie     premie    &lt;chr&gt; 998         1             0.1        2      -
marital   marital    &lt;chr&gt; 999         0             0.0        2      -
gender     gender    &lt;chr&gt; 999         0             0.0        2      -
habit       habit    &lt;chr&gt; 999         0             0.0        2      -
whitemom whitemom    &lt;chr&gt; 997         2             0.2        2      -
         levels_count levels_percent
mature              -              -
premie              -              -
marital             -              -
gender              -              -
habit               -              -
whitemom            -              -</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mydata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   999 obs. of  12 variables:
 $ fage    : int  NA NA 19 21 NA NA 18 17 NA 20 ...
 $ mage    : int  13 14 15 15 15 15 15 15 16 16 ...
 $ mature  : chr  "younger mom" "younger mom" "younger mom" "younger mom" ...
 $ weeks   : int  39 42 37 41 39 38 37 35 38 37 ...
 $ premie  : chr  "full term" "full term" "full term" "full term" ...
 $ visits  : int  10 15 11 6 9 19 12 5 9 13 ...
 $ marital : chr  "married" "married" "married" "married" ...
 $ gained  : int  38 20 38 34 27 22 76 15 NA 52 ...
 $ weight  : num  7.63 7.88 6.63 8 6.38 5.38 8.44 4.69 8.81 6.94 ...
 $ gender  : chr  "male" "male" "female" "male" ...
 $ habit   : chr  "nonsmoker" "nonsmoker" "nonsmoker" "nonsmoker" ...
 $ whitemom: chr  "not white" "not white" "white" "white" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(mydata, <span class="at">n=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 12%">
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">fage</th>
<th style="text-align: right;">mage</th>
<th style="text-align: left;">mature</th>
<th style="text-align: right;">weeks</th>
<th style="text-align: left;">premie</th>
<th style="text-align: right;">visits</th>
<th style="text-align: left;">marital</th>
<th style="text-align: right;">gained</th>
<th style="text-align: right;">weight</th>
<th style="text-align: left;">gender</th>
<th style="text-align: left;">habit</th>
<th style="text-align: left;">whitemom</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">younger mom</td>
<td style="text-align: right;">39</td>
<td style="text-align: left;">full term</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">married</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">7.63</td>
<td style="text-align: left;">male</td>
<td style="text-align: left;">nonsmoker</td>
<td style="text-align: left;">not white</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#checking missing values</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(mydata, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    fage     mage   mature    weeks   premie   visits  marital   gained 
     170        0        0        1        1        8        0       26 
  weight   gender    habit whitemom 
       0        0        0        2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#replace numerical with median</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 999
Columns: 12
$ fage     &lt;int&gt; NA, NA, 19, 21, NA, NA, 18, 17, NA, 20, 30, NA, NA, NA, 21, N…
$ mage     &lt;int&gt; 13, 14, 15, 15, 15, 15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 1…
$ mature   &lt;chr&gt; "younger mom", "younger mom", "younger mom", "younger mom", "…
$ weeks    &lt;int&gt; 39, 42, 37, 41, 39, 38, 37, 35, 38, 37, 45, 42, 40, 38, 38, 4…
$ premie   &lt;chr&gt; "full term", "full term", "full term", "full term", "full ter…
$ visits   &lt;int&gt; 10, 15, 11, 6, 9, 19, 12, 5, 9, 13, 9, 8, 4, 12, 15, 7, 12, 5…
$ marital  &lt;chr&gt; "married", "married", "married", "married", "married", "marri…
$ gained   &lt;int&gt; 38, 20, 38, 34, 27, 22, 76, 15, NA, 52, 28, 34, 12, 30, 75, 3…
$ weight   &lt;dbl&gt; 7.63, 7.88, 6.63, 8.00, 6.38, 5.38, 8.44, 4.69, 8.81, 6.94, 7…
$ gender   &lt;chr&gt; "male", "male", "female", "male", "female", "male", "male", "…
$ habit    &lt;chr&gt; "nonsmoker", "nonsmoker", "nonsmoker", "nonsmoker", "nonsmoke…
$ whitemom &lt;chr&gt; "not white", "not white", "white", "white", "not white", "not…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df.noNAs <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(., <span class="fu">median</span>(., <span class="at">na.rm=</span><span class="cn">TRUE</span>))))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df.noNAs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 999
Columns: 12
$ fage     &lt;int&gt; 30, 30, 19, 21, 30, 30, 18, 17, 30, 20, 30, 30, 30, 30, 21, 3…
$ mage     &lt;int&gt; 13, 14, 15, 15, 15, 15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 1…
$ mature   &lt;chr&gt; "younger mom", "younger mom", "younger mom", "younger mom", "…
$ weeks    &lt;int&gt; 39, 42, 37, 41, 39, 38, 37, 35, 38, 37, 45, 42, 40, 38, 38, 4…
$ premie   &lt;chr&gt; "full term", "full term", "full term", "full term", "full ter…
$ visits   &lt;int&gt; 10, 15, 11, 6, 9, 19, 12, 5, 9, 13, 9, 8, 4, 12, 15, 7, 12, 5…
$ marital  &lt;chr&gt; "married", "married", "married", "married", "married", "marri…
$ gained   &lt;int&gt; 38, 20, 38, 34, 27, 22, 76, 15, 30, 52, 28, 34, 12, 30, 75, 3…
$ weight   &lt;dbl&gt; 7.63, 7.88, 6.63, 8.00, 6.38, 5.38, 8.44, 4.69, 8.81, 6.94, 7…
$ gender   &lt;chr&gt; "male", "male", "female", "male", "female", "male", "male", "…
$ habit    &lt;chr&gt; "nonsmoker", "nonsmoker", "nonsmoker", "nonsmoker", "nonsmoke…
$ whitemom &lt;chr&gt; "not white", "not white", "white", "white", "not white", "not…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replace categorial with mode</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>Mode <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    ux <span class="ot">&lt;-</span> <span class="fu">unique</span>(x)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    ux[<span class="fu">which.max</span>(<span class="fu">tabulate</span>(<span class="fu">match</span>(x, ux)))]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>df.noNAs[<span class="fu">is.na</span>(df.noNAs)] <span class="ot">&lt;-</span> <span class="fu">Mode</span>(df.noNAs)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ExpData</span>(<span class="at">data=</span>df.noNAs,<span class="at">type=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Index Variable_Name Variable_Type Sample_n Missing_Count Per_of_Missing
1      1          fage       integer      999             0              0
2      2          mage       integer      999             0              0
3      3        mature     character      999             0              0
4      4         weeks       integer      999             0              0
5      5        premie          list      999             0              0
6      6        visits       integer      999             0              0
7      7       marital     character      999             0              0
8      8        gained       integer      999             0              0
9      9        weight       numeric      999             0              0
10    10        gender     character      999             0              0
11    11         habit     character      999             0              0
12    12      whitemom          list      999             0              0
   No_of_distinct_values
1                     37
2                     33
3                      2
4                     23
5                      3
6                     26
7                      2
8                     71
9                    126
10                     2
11                     2
12                     3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#identify and removal of categorial variables</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df.noNAs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   999 obs. of  12 variables:
 $ fage    : int  30 30 19 21 30 30 18 17 30 20 ...
 $ mage    : int  13 14 15 15 15 15 15 15 16 16 ...
 $ mature  : chr  "younger mom" "younger mom" "younger mom" "younger mom" ...
 $ weeks   : int  39 42 37 41 39 38 37 35 38 37 ...
 $ premie  :List of 999
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "premie"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "premie"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "premie"
  ..$ : chr "premie"
  ..$ : chr "premie"
  ..$ : chr "premie"
  ..$ : chr "premie"
  ..$ : chr "premie"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "premie"
  ..$ : chr "premie"
  ..$ : chr "premie"
  ..$ : chr "premie"
  ..$ : chr "premie"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  ..$ : chr "full term"
  .. [list output truncated]
 $ visits  : int  10 15 11 6 9 19 12 5 9 13 ...
 $ marital : chr  "married" "married" "married" "married" ...
 $ gained  : int  38 20 38 34 27 22 76 15 30 52 ...
 $ weight  : num  7.63 7.88 6.63 8 6.38 5.38 8.44 4.69 8.81 6.94 ...
 $ gender  : chr  "male" "male" "female" "male" ...
 $ habit   : chr  "nonsmoker" "nonsmoker" "nonsmoker" "nonsmoker" ...
 $ whitemom:List of 999
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "white"
  ..$ : chr "not white"
  ..$ : chr "not white"
  ..$ : chr "white"
  ..$ : chr "not white"
  .. [list output truncated]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>no_cat<span class="ot">&lt;-</span> df.noNAs <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>mature, <span class="sc">-</span> premie, <span class="sc">-</span> marital, <span class="sc">-</span> gender, <span class="sc">-</span> habit, <span class="sc">-</span> whitemom)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(no_cat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  fage mage weeks visits gained weight
1   30   13    39     10     38   7.63
2   30   14    42     15     20   7.88
3   19   15    37     11     38   6.63
4   21   15    41      6     34   8.00
5   30   15    39      9     27   6.38
6   30   15    38     19     22   5.38</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">round</span>(<span class="fu">cor</span>(no_cat), <span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        fage  mage weeks visits gained weight
fage    1.00  0.71 -0.01   0.07  -0.04   0.06
mage    0.71  1.00 -0.03   0.16  -0.06   0.06
weeks  -0.01 -0.03  1.00   0.17   0.09   0.67
visits  0.07  0.16  0.17   1.00   0.06   0.13
gained -0.04 -0.06  0.09   0.06   1.00   0.15
weight  0.06  0.06  0.67   0.13   0.15   1.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># Weeks has the highest correlation in comparison with weight (target variable) at 0.67</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a> <span class="co">#Scatterplot of relationship between weeks and weight </span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(<span class="at">data=</span> no_cat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> weeks, <span class="at">y =</span> weight))<span class="sc">+</span><span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#generally speaking when weeks are below 27 the weight is fairly consistent in that weight is below 3- with the exception of one outlier.  Then above 27 weeks the correlation is seen very well in that the more weeks accrued the more weight gained until about 37 weeks when the range increases significantly.  The weight at 37 weeks - 40 weeks varies from 3-12 until about 43rd week where the variation is reduced to the weight range of 6-9.  </span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Please provide your code for Task 2 in this code chunk</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># split the sample by using rsample package</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into a training set (70%) and a test set (30%)</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>split<span class="ot">&lt;-</span> <span class="fu">initial_split</span>(no_cat, <span class="at">prop =</span> <span class="fl">0.70</span>, <span class="at">strata =</span> <span class="st">"weight"</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span><span class="fu">training</span>(split)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>test_data<span class="ot">&lt;-</span><span class="fu">testing</span>(split)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(train_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 698   6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(test_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 301   6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Please provide your code for Task 3  in this code chunk</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'psych'

The following objects are masked from 'package:ggplot2':

    %+%, alpha</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">#lm function to estimate</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>linearmodel<span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> fage<span class="sc">+</span>mage<span class="sc">+</span>weeks<span class="sc">+</span>visits<span class="sc">+</span>gained, <span class="at">data =</span> train_data)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(linearmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ fage + mage + weeks + visits + gained, 
    data = train_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.5095 -0.7245 -0.0344  0.7819  4.3711 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -7.069515   0.581129 -12.165  &lt; 2e-16 ***
fage         0.014971   0.009724   1.540  0.12413    
mage         0.010142   0.009666   1.049  0.29445    
weeks        0.339776   0.014522  23.397  &lt; 2e-16 ***
visits       0.012027   0.010808   1.113  0.26622    
gained       0.008512   0.003048   2.793  0.00537 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.102 on 692 degrees of freedom
Multiple R-squared:  0.4722,    Adjusted R-squared:  0.4683 
F-statistic: 123.8 on 5 and 692 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#predict function on test_data</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>predicted_weights_ols<span class="ot">&lt;-</span> <span class="fu">predict</span>(linearmodel, test_data)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>predicted_weights_ols</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3        4        5        6        7        8 
7.206459 8.142845 7.689404 6.396338 7.521283 6.791298 6.863208 7.259949 
       9       10       11       12       13       14       15       16 
7.604745 6.969011 7.752944 7.057828 6.941123 6.332564 7.767024 6.929965 
      17       18       19       20       21       22       23       24 
8.837429 6.353081 7.449417 6.799806 6.972673 7.589810 7.746632 7.848207 
      25       26       27       28       29       30       31       32 
5.294945 5.955056 6.092983 7.129457 7.402918 6.292921 6.746848 7.793767 
      33       34       35       36       37       38       39       40 
8.256526 6.905086 7.179371 6.433591 7.917666 8.278453 6.828455 7.021316 
      41       42       43       44       45       46       47       48 
7.202876 7.940847 7.408036 7.824577 7.609976 6.495756 4.826169 5.177585 
      49       50       51       52       53       54       55       56 
5.056527 6.207052 6.928716 6.939441 6.958956 7.582710 7.930428 8.064591 
      57       58       59       60       61       62       63       64 
7.050143 7.327507 7.984173 6.564225 7.440815 5.502110 6.780215 7.041163 
      65       66       67       68       69       70       71       72 
7.327632 7.501869 6.574142 7.224345 6.590618 7.518297 7.294746 7.902848 
      73       74       75       76       77       78       79       80 
7.120466 7.126307 7.539432 7.333818 4.144065 6.818768 8.187750 7.904615 
      81       82       83       84       85       86       87       88 
6.891745 7.081912 7.309021 6.695119 8.450645 6.966621 6.480971 7.371525 
      89       90       91       92       93       94       95       96 
6.541723 6.384809 6.211872 5.006255 7.593739 7.089950 7.289222 6.647254 
      97       98       99      100      101      102      103      104 
8.233174 7.934431 7.012843 9.030049 7.247574 7.232010 7.436129 6.863732 
     105      106      107      108      109      110      111      112 
7.196228 7.758461 6.131373 5.661927 6.601054 6.906781 7.728074 7.773756 
     113      114      115      116      117      118      119      120 
6.816780 7.072575 6.647445 7.621225 7.223053 7.264403 7.151267 7.473644 
     121      122      123      124      125      126      127      128 
6.908264 7.532909 7.297082 8.311321 8.034693 7.236584 6.808971 7.377754 
     129      130      131      132      133      134      135      136 
7.515271 6.818418 7.497400 7.802950 7.516205 5.903862 5.695574 6.950652 
     137      138      139      140      141      142      143      144 
7.009943 7.304530 8.392232 7.031666 7.977330 7.687166 8.213341 7.574134 
     145      146      147      148      149      150      151      152 
7.658685 7.813840 7.987347 7.305348 8.482849 8.340861 8.974637 8.349672 
     153      154      155      156      157      158      159      160 
7.601271 4.457111 5.011991 6.846349 7.912964 6.562691 8.552852 7.619833 
     161      162      163      164      165      166      167      168 
7.518851 7.491356 7.103079 7.049750 7.352806 7.247764 7.272388 5.782700 
     169      170      171      172      173      174      175      176 
7.410985 7.788144 7.295767 7.527060 9.062128 6.578398 6.969795 8.014959 
     177      178      179      180      181      182      183      184 
7.068404 7.200625 6.960985 2.575002 5.981847 7.358050 8.028295 7.170602 
     185      186      187      188      189      190      191      192 
6.942352 6.913695 7.325580 6.953786 9.187355 6.520969 6.432035 7.222495 
     193      194      195      196      197      198      199      200 
7.413329 7.144888 5.901870 1.510635 5.516633 7.337161 7.338666 8.520274 
     201      202      203      204      205      206      207      208 
6.836956 7.905900 7.395190 6.936931 7.021949 8.168934 7.124095 7.887856 
     209      210      211      212      213      214      215      216 
6.968182 6.801321 7.036622 6.707389 7.128750 6.686850 7.852325 7.930119 
     217      218      219      220      221      222      223      224 
8.049838 7.686626 6.359693 6.364713 7.321387 7.591973 7.958059 7.013013 
     225      226      227      228      229      230      231      232 
8.654337 6.706395 7.710186 7.554958 6.894553 7.161805 7.493389 7.284667 
     233      234      235      236      237      238      239      240 
5.242222 3.180773 5.547769 8.623435 7.199718 7.006131 6.965326 6.980275 
     241      242      243      244      245      246      247      248 
6.499306 6.796639 7.371286 7.431327 7.169776 7.169301 8.147073 6.403166 
     249      250      251      252      253      254      255      256 
6.311015 8.176452 7.219770 7.476066 7.167192 7.928256 7.462280 6.767757 
     257      258      259      260      261      262      263      264 
7.021819 8.163833 6.706689 7.485461 7.235941 7.906234 8.131289 6.347607 
     265      266      267      268      269      270      271      272 
7.741456 7.350746 7.836845 7.712357 7.472422 6.857357 7.195949 5.911672 
     273      274      275      276      277      278      279      280 
6.551110 6.575462 3.642185 7.391555 7.003672 7.432312 7.430921 6.982839 
     281      282      283      284      285      286      287      288 
4.701394 7.571214 7.530296 7.234493 7.417701 7.841886 6.957809 7.598812 
     289      290      291      292      293      294      295      296 
8.184160 8.353811 0.816149 4.894311 7.875087 7.426209 7.812333 8.255838 
     297      298      299      300      301 
6.299358 6.340733 7.121022 7.494825 5.062497 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculating MSPE</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linearmodel, <span class="at">newdata =</span> test_data, <span class="at">interval =</span> <span class="st">"prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         fit        lwr       upr
1   7.206459  5.0258781  9.387041
2   8.142845  5.9584115 10.327279
3   7.689404  5.5142955  9.864512
4   6.396338  4.2242397  8.568436
5   7.521283  5.3474988  9.695067
6   6.791298  4.6216358  8.960960
7   6.863208  4.6900601  9.036355
8   7.259949  5.0861020  9.433796
9   7.604745  5.4312864  9.778203
10  6.969011  4.7937471  9.144275
11  7.752944  5.5822309  9.923657
12  7.057828  4.8877716  9.227884
13  6.941123  4.7553423  9.126905
14  6.332564  4.1592026  8.505926
15  7.767024  5.5955203  9.938528
16  6.929965  4.7561969  9.103733
17  8.837429  6.6564419 11.018417
18  6.353081  4.1835424  8.522620
19  7.449417  5.2783748  9.620458
20  6.799806  4.6302349  8.969376
21  6.972673  4.7969529  9.148392
22  7.589810  5.4112432  9.768377
23  7.746632  5.5744108  9.918853
24  7.848207  5.6777648 10.018650
25  5.294945  3.1106278  7.479262
26  5.955056  3.7783149  8.131796
27  6.092983  3.9237749  8.262192
28  7.129457  4.9547666  9.304148
29  7.402918  5.2326717  9.573164
30  6.292921  4.1228515  8.462991
31  6.746848  4.5778744  8.915822
32  7.793767  5.6233171  9.964216
33  8.256526  6.0860765 10.426975
34  6.905086  4.7332630  9.076910
35  7.179371  5.0061719  9.352571
36  6.433591  4.2565795  8.610602
37  7.917666  5.7382544 10.097078
38  8.278453  6.1013408 10.455564
39  6.828455  4.6602084  8.996702
40  7.021316  4.8509787  9.191654
41  7.202876  5.0331451  9.372607
42  7.940847  5.7701803 10.111514
43  7.408036  5.2338721  9.582201
44  7.824577  5.6530981  9.996056
45  7.609976  5.4282009  9.791752
46  6.495756  4.3263255  8.665186
47  4.826169  2.6396642  7.012673
48  5.177585  2.9996014  7.355569
49  5.056527  2.8814034  7.231650
50  6.207052  4.0371982  8.376907
51  6.928716  4.7587250  9.098708
52  6.939441  4.7647099  9.114172
53  6.958956  4.7914934  9.126419
54  7.582710  5.4136429  9.751778
55  7.930428  5.7616868 10.099170
56  8.064591  5.8896012 10.239581
57  7.050143  4.8806747  9.219611
58  7.327507  5.1551805  9.499834
59  7.984173  5.8144183 10.153928
60  6.564225  4.3846766  8.743773
61  7.440815  5.2680518  9.613578
62  5.502110  3.3303821  7.673839
63  6.780215  4.6064367  8.953993
64  7.041163  4.8707687  9.211557
65  7.327632  5.1583311  9.496933
66  7.501869  5.3306172  9.673120
67  6.574142  4.4067684  8.741515
68  7.224345  5.0580340  9.390657
69  6.590618  4.4210828  8.760153
70  7.518297  5.3489578  9.687635
71  7.294746  5.1226458  9.466847
72  7.902848  5.7091204 10.096576
73  7.120466  4.9511249  9.289807
74  7.126307  4.9593730  9.293240
75  7.539432  5.3681615  9.710702
76  7.333818  5.1662667  9.501370
77  4.144065  1.9637592  6.324370
78  6.818768  4.6279117  9.009624
79  8.187750  6.0182876 10.357213
80  7.904615  5.7362541 10.072976
81  6.891745  4.7246789  9.058811
82  7.081912  4.9080008  9.255824
83  7.309021  5.1425301  9.475512
84  6.695119  4.5258622  8.864376
85  8.450645  6.2744425 10.626848
86  6.966621  4.8002072  9.133035
87  6.480971  4.3131031  8.648840
88  7.371525  5.1950766  9.547973
89  6.541723  4.3748065  8.708640
90  6.384809  4.2147831  8.554835
91  6.211872  4.0392108  8.384534
92  5.006255  2.8287984  7.183711
93  7.593739  5.4202353  9.767242
94  7.089950  4.9222902  9.257609
95  7.289222  5.1227382  9.455705
96  6.647254  4.4788939  8.815615
97  8.233174  6.0620288 10.404319
98  7.934431  5.7641533 10.104709
99  7.012843  4.8457553  9.179931
100 9.030049  6.8557504 11.204348
101 7.247574  5.0814662  9.413681
102 7.232010  5.0664356  9.397585
103 7.436129  5.2379015  9.634356
104 6.863732  4.6962991  9.031164
105 7.196228  5.0275505  9.364906
106 7.758461  5.5904088  9.926514
107 6.131373  3.9607754  8.301970
108 5.661927  3.4857415  7.838112
109 6.601054  4.4353785  8.766729
110 6.906781  4.7412731  9.072290
111 7.728074  5.5610695  9.895079
112 7.773756  5.6031854  9.944327
113 6.816780  4.6470143  8.986545
114 7.072575  4.9039168  9.241233
115 6.647445  4.4728541  8.822037
116 7.621225  5.4526458  9.789805
117 7.223053  5.0560697  9.390036
118 7.264403  5.0942743  9.434531
119 7.151267  4.9401032  9.362431
120 7.473644  5.3046082  9.642681
121 6.908264  4.7421749  9.074354
122 7.532909  5.3664919  9.699327
123 7.297082  5.1273668  9.466797
124 8.311321  6.1388064 10.483836
125 8.034693  5.8670201 10.202365
126 7.236584  5.0708682  9.402301
127 6.808971  4.6347885  8.983153
128 7.377754  5.2115673  9.543941
129 7.515271  5.3455165  9.685025
130 6.818418  4.6517027  8.985132
131 7.497400  5.3301232  9.664676
132 7.802950  5.6339060  9.971995
133 7.516205  5.3480656  9.684345
134 5.903862  3.7321029  8.075622
135 5.695574  3.5150706  7.876077
136 6.950652  4.7845968  9.116707
137 7.009943  4.8424602  9.177425
138 7.304530  5.1368674  9.472193
139 8.392232  6.2240484 10.560416
140 7.031666  4.8656273  9.197705
141 7.977330  5.8107971 10.143863
142 7.687166  5.5211622  9.853169
143 8.213341  6.0339830 10.392698
144 7.574134  5.4068078  9.741460
145 7.658685  5.4927163  9.824654
146 7.813840  5.6445262  9.983154
147 7.987347  5.8183480 10.156346
148 7.305348  5.1266252  9.484070
149 8.482849  6.3094589 10.656239
150 8.340861  6.1715903 10.510133
151 8.974637  6.8029505 11.146323
152 8.349672  6.1814544 10.517889
153 7.601271  5.4262402  9.776301
154 4.457111  2.2702778  6.643944
155 5.011991  2.8385574  7.185425
156 6.846349  4.6786648  9.014034
157 7.912964  5.7386066 10.087321
158 6.562691  4.3832564  8.742126
159 8.552852  6.3816487 10.724055
160 7.619833  5.4497828  9.789884
161 7.518851  5.3487476  9.688954
162 7.491356  5.3204795  9.662232
163 7.103079  4.9333382  9.272821
164 7.049750  4.8838998  9.215601
165 7.352806  5.1826737  9.522938
166 7.247764  5.0819322  9.413596
167 7.272388  5.1057157  9.439060
168 5.782700  3.6139535  7.951447
169 7.410985  5.2372431  9.584728
170 7.788144  5.6196355  9.956653
171 7.295767  5.1279419  9.463593
172 7.527060  5.3415467  9.712574
173 9.062128  6.8900880 11.234167
174 6.578398  4.4073271  8.749468
175 6.969795  4.8037395  9.135851
176 8.014959  5.8475384 10.182379
177 7.068404  4.9022349  9.234574
178 7.200625  5.0309046  9.370345
179 6.960985  4.7914129  9.130557
180 2.575002  0.3759388  4.774065
181 5.981847  3.8134030  8.150291
182 7.358050  5.1826833  9.533417
183 8.028295  5.8613899 10.195200
184 7.170602  5.0020106  9.339193
185 6.942352  4.7766991  9.108005
186 6.913695  4.7427661  9.084623
187 7.325580  5.1600216  9.491138
188 6.953786  4.7872797  9.120293
189 9.187355  7.0126241 11.362085
190 6.520969  4.3531578  8.688780
191 6.432035  4.2616098  8.602460
192 7.222495  5.0475784  9.397413
193 7.413329  5.2405050  9.586153
194 7.144888  4.9779175  9.311859
195 5.901870  3.7309717  8.072768
196 1.510635 -0.7063667  3.727637
197 5.516633  3.3471457  7.686120
198 7.337161  5.1695173  9.504804
199 7.338666  5.1724610  9.504871
200 8.520274  6.3515402 10.689008
201 6.836956  4.6688607  9.005051
202 7.905900  5.7333633 10.078438
203 7.395190  5.2203660  9.570013
204 6.936931  4.7705001  9.103362
205 7.021949  4.8552146  9.188684
206 8.168934  5.9928829 10.344986
207 7.124095  4.9569318  9.291258
208 7.887856  5.7200594 10.055653
209 6.968182  4.7996939  9.136671
210 6.801321  4.6342304  8.968411
211 7.036622  4.8700843  9.203159
212 6.707389  4.5412102  8.873568
213 7.128750  4.9621118  9.295389
214 6.686850  4.5207295  8.852971
215 7.852325  5.6846917 10.019958
216 7.930119  5.7576930 10.102545
217 8.049838  5.8679171 10.231759
218 7.686626  5.5145126  9.858740
219 6.359693  4.1920272  8.527359
220 6.364713  4.1932380  8.536188
221 7.321387  5.1535713  9.489203
222 7.591973  5.4193323  9.764613
223 7.958059  5.7885764 10.127541
224 7.013013  4.8453925  9.180634
225 8.654337  6.4787392 10.829935
226 6.706395  4.5397947  8.872996
227 7.710186  5.5304429  9.889930
228 7.554958  5.3832014  9.726714
229 6.894553  4.7242790  9.064827
230 7.161805  4.9951145  9.328495
231 7.493389  5.3249331  9.661845
232 7.284667  5.1145933  9.454740
233 5.242222  3.0699098  7.414535
234 3.180773  0.9782909  5.383256
235 5.547769  3.3659421  7.729596
236 8.623435  6.4358269 10.811043
237 7.199718  5.0253491  9.374086
238 7.006131  4.8379779  9.174284
239 6.965326  4.7968422  9.133809
240 6.980275  4.8124994  9.148050
241 6.499306  4.3251160  8.673497
242 6.796639  4.6290195  8.964259
243 7.371286  5.1661050  9.576467
244 7.431327  5.2610450  9.601609
245 7.169776  4.9957227  9.343830
246 7.169301  5.0013924  9.337210
247 8.147073  5.9616056 10.332541
248 6.403166  4.2346076  8.571724
249 6.311015  4.1411746  8.480856
250 8.176452  6.0077760 10.345128
251 7.219770  5.0343003  9.405239
252 7.476066  5.3054231  9.646709
253 7.167192  4.9856637  9.348719
254 7.928256  5.7593397 10.097172
255 7.462280  5.2951897  9.629371
256 6.767757  4.6002644  8.935250
257 7.021819  4.8527204  9.190918
258 8.163833  5.9951334 10.332532
259 6.706689  4.5379389  8.875439
260 7.485461  5.2968459  9.674077
261 7.235941  5.0596285  9.412253
262 7.906234  5.7374551 10.075013
263 8.131289  5.9618396 10.300739
264 6.347607  4.1757278  8.519485
265 7.741456  5.5708725  9.912039
266 7.350746  5.1787667  9.522725
267 7.836845  5.6678365 10.005853
268 7.712357  5.5385361  9.886177
269 7.472422  5.3046836  9.640161
270 6.857357  4.6831571  9.031557
271 7.195949  5.0201508  9.371746
272 5.911672  3.7391921  8.084151
273 6.551110  4.3804709  8.721750
274 6.575462  4.3995692  8.751355
275 3.642185  1.4524115  5.831958
276 7.391555  5.2211521  9.561958
277 7.003672  4.8332853  9.174058
278 7.432312  5.2557101  9.608915
279 7.430921  5.2619049  9.599937
280 6.982839  4.8095491  9.156128
281 4.701394  2.5069119  6.895876
282 7.571214  5.3873164  9.755113
283 7.530296  5.3563976  9.704194
284 7.234493  5.0628641  9.406122
285 7.417701  5.2397729  9.595630
286 7.841886  5.6721650 10.011606
287 6.957809  4.7730760  9.142543
288 7.598812  5.4280153  9.769609
289 8.184160  6.0118064 10.356514
290 8.353811  6.1810867 10.526535
291 0.816149 -1.4279016  3.060200
292 4.894311  2.7110550  7.077566
293 7.875087  5.7035277 10.046647
294 7.426209  5.2512246  9.601194
295 7.812333  5.6337653  9.990901
296 8.255838  6.0808237 10.430852
297 6.299358  4.1242063  8.474509
298 6.340733  4.1625222  8.518944
299 7.121022  4.9449893  9.297055
300 7.494825  5.3180468  9.671603
301 5.062497  2.8597273  7.265267</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict.lm</span>(linearmodel, <span class="at">newdata =</span> test_data, <span class="at">interval =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3        4        5        6        7        8 
7.206459 8.142845 7.689404 6.396338 7.521283 6.791298 6.863208 7.259949 
       9       10       11       12       13       14       15       16 
7.604745 6.969011 7.752944 7.057828 6.941123 6.332564 7.767024 6.929965 
      17       18       19       20       21       22       23       24 
8.837429 6.353081 7.449417 6.799806 6.972673 7.589810 7.746632 7.848207 
      25       26       27       28       29       30       31       32 
5.294945 5.955056 6.092983 7.129457 7.402918 6.292921 6.746848 7.793767 
      33       34       35       36       37       38       39       40 
8.256526 6.905086 7.179371 6.433591 7.917666 8.278453 6.828455 7.021316 
      41       42       43       44       45       46       47       48 
7.202876 7.940847 7.408036 7.824577 7.609976 6.495756 4.826169 5.177585 
      49       50       51       52       53       54       55       56 
5.056527 6.207052 6.928716 6.939441 6.958956 7.582710 7.930428 8.064591 
      57       58       59       60       61       62       63       64 
7.050143 7.327507 7.984173 6.564225 7.440815 5.502110 6.780215 7.041163 
      65       66       67       68       69       70       71       72 
7.327632 7.501869 6.574142 7.224345 6.590618 7.518297 7.294746 7.902848 
      73       74       75       76       77       78       79       80 
7.120466 7.126307 7.539432 7.333818 4.144065 6.818768 8.187750 7.904615 
      81       82       83       84       85       86       87       88 
6.891745 7.081912 7.309021 6.695119 8.450645 6.966621 6.480971 7.371525 
      89       90       91       92       93       94       95       96 
6.541723 6.384809 6.211872 5.006255 7.593739 7.089950 7.289222 6.647254 
      97       98       99      100      101      102      103      104 
8.233174 7.934431 7.012843 9.030049 7.247574 7.232010 7.436129 6.863732 
     105      106      107      108      109      110      111      112 
7.196228 7.758461 6.131373 5.661927 6.601054 6.906781 7.728074 7.773756 
     113      114      115      116      117      118      119      120 
6.816780 7.072575 6.647445 7.621225 7.223053 7.264403 7.151267 7.473644 
     121      122      123      124      125      126      127      128 
6.908264 7.532909 7.297082 8.311321 8.034693 7.236584 6.808971 7.377754 
     129      130      131      132      133      134      135      136 
7.515271 6.818418 7.497400 7.802950 7.516205 5.903862 5.695574 6.950652 
     137      138      139      140      141      142      143      144 
7.009943 7.304530 8.392232 7.031666 7.977330 7.687166 8.213341 7.574134 
     145      146      147      148      149      150      151      152 
7.658685 7.813840 7.987347 7.305348 8.482849 8.340861 8.974637 8.349672 
     153      154      155      156      157      158      159      160 
7.601271 4.457111 5.011991 6.846349 7.912964 6.562691 8.552852 7.619833 
     161      162      163      164      165      166      167      168 
7.518851 7.491356 7.103079 7.049750 7.352806 7.247764 7.272388 5.782700 
     169      170      171      172      173      174      175      176 
7.410985 7.788144 7.295767 7.527060 9.062128 6.578398 6.969795 8.014959 
     177      178      179      180      181      182      183      184 
7.068404 7.200625 6.960985 2.575002 5.981847 7.358050 8.028295 7.170602 
     185      186      187      188      189      190      191      192 
6.942352 6.913695 7.325580 6.953786 9.187355 6.520969 6.432035 7.222495 
     193      194      195      196      197      198      199      200 
7.413329 7.144888 5.901870 1.510635 5.516633 7.337161 7.338666 8.520274 
     201      202      203      204      205      206      207      208 
6.836956 7.905900 7.395190 6.936931 7.021949 8.168934 7.124095 7.887856 
     209      210      211      212      213      214      215      216 
6.968182 6.801321 7.036622 6.707389 7.128750 6.686850 7.852325 7.930119 
     217      218      219      220      221      222      223      224 
8.049838 7.686626 6.359693 6.364713 7.321387 7.591973 7.958059 7.013013 
     225      226      227      228      229      230      231      232 
8.654337 6.706395 7.710186 7.554958 6.894553 7.161805 7.493389 7.284667 
     233      234      235      236      237      238      239      240 
5.242222 3.180773 5.547769 8.623435 7.199718 7.006131 6.965326 6.980275 
     241      242      243      244      245      246      247      248 
6.499306 6.796639 7.371286 7.431327 7.169776 7.169301 8.147073 6.403166 
     249      250      251      252      253      254      255      256 
6.311015 8.176452 7.219770 7.476066 7.167192 7.928256 7.462280 6.767757 
     257      258      259      260      261      262      263      264 
7.021819 8.163833 6.706689 7.485461 7.235941 7.906234 8.131289 6.347607 
     265      266      267      268      269      270      271      272 
7.741456 7.350746 7.836845 7.712357 7.472422 6.857357 7.195949 5.911672 
     273      274      275      276      277      278      279      280 
6.551110 6.575462 3.642185 7.391555 7.003672 7.432312 7.430921 6.982839 
     281      282      283      284      285      286      287      288 
4.701394 7.571214 7.530296 7.234493 7.417701 7.841886 6.957809 7.598812 
     289      290      291      292      293      294      295      296 
8.184160 8.353811 0.816149 4.894311 7.875087 7.426209 7.812333 8.255838 
     297      298      299      300      301 
6.299358 6.340733 7.121022 7.494825 5.062497 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ISLR2'

The following objects are masked from 'package:ISLR':

    Auto, Credit</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(CombMSC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'CombMSC'

The following object is masked from 'package:stats':

    BIC</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'

The following object is masked from 'package:ISLR2':

    Boston

The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix

Attaching package: 'Matrix'

The following objects are masked from 'package:tidyr':

    expand, pack, unpack

Loaded glmnet 4.1-8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'boot'

The following object is masked from 'package:psych':

    logit

The following object is masked from 'package:lattice':

    melanoma</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>model_full<span class="ot">&lt;-</span><span class="fu">lm</span>(weight <span class="sc">~</span> fage<span class="sc">+</span>mage<span class="sc">+</span>weeks<span class="sc">+</span>visits<span class="sc">+</span>gained, <span class="at">data =</span> train_data)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>y.train <span class="ot">=</span> train_data<span class="sc">$</span>weight</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>predictors.train <span class="ot">=</span> train_data[,<span class="sc">-</span><span class="dv">6</span>]</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>y.test <span class="ot">=</span> test_data<span class="sc">$</span>weight</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>predictors.test <span class="ot">=</span> test_data[,<span class="sc">-</span><span class="dv">6</span>]</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>RidgeCV <span class="ot">=</span> <span class="fu">cv.glmnet</span>(<span class="fu">as.matrix</span>(predictors.train), y.train,</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family=</span><span class="st">'gaussian'</span>, <span class="at">type.measure=</span><span class="st">"mse"</span>, <span class="at">alpha=</span><span class="dv">0</span>, <span class="at">nfolds=</span><span class="dv">10</span>)</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(RidgeCV)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>RidgeCV<span class="sc">$</span>lambda</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 1019.4933751  928.9243935  846.4013106  771.2093509  702.6972377
  [6]  640.2715518  583.3915918  531.5646907  484.3419486  441.3143448
 [11]  402.1091947  366.3869221  333.8381178  304.1808595  277.1582703
 [16]  252.5362934  230.1016652  209.6600674  191.0344449  174.0634713
 [21]  158.6001522  144.5105518  131.6726327  119.9751989  109.3169329
 [26]   99.6055179   90.7568382   82.6942508   75.3479215   68.6542198
 [31]   62.5551682   56.9979394   51.9343996   47.3206907   43.1168509
 [36]   39.2864687   35.7963671   32.6163165   29.7187729   27.0786390
 [41]   24.6730473   22.4811618   20.4839974   18.6642555   17.0061745
 [46]   15.4953928   14.1188248   12.8645473   11.7216964   10.6803732
 [51]    9.7315583    8.8670335    8.0793106    7.3615670    6.7075856
 [56]    6.1117022    5.5687554    5.0740426    4.6232786    4.2125593
 [61]    3.8383271    3.4973407    3.1866466    2.9035537    2.6456100
 [66]    2.4105813    2.1964319    2.0013069    1.8235163    1.6615202
 [71]    1.5139153    1.3794232    1.2568791    1.1452214    1.0434831
 [76]    0.9507829    0.8663180    0.7893567    0.7192324    0.6553378
 [81]    0.5971194    0.5440730    0.4957390    0.4516989    0.4115712
 [86]    0.3750084    0.3416937    0.3113385    0.2836801    0.2584787
 [91]    0.2355162    0.2145936    0.1955297    0.1781594    0.1623322
 [96]    0.1479110    0.1347710    0.1227983    0.1118893    0.1019493</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>RidgeCV<span class="sc">$</span>cvm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 2.287161 2.284553 2.283307 2.282899 2.282451 2.281960 2.281422 2.280831
  [9] 2.280184 2.279474 2.278696 2.277843 2.276908 2.275884 2.274761 2.273531
 [17] 2.272184 2.270708 2.269093 2.267324 2.265389 2.263271 2.260954 2.258421
 [25] 2.255652 2.252627 2.249322 2.245715 2.241778 2.237485 2.232806 2.227710
 [33] 2.222164 2.216131 2.209576 2.202459 2.194741 2.186379 2.177331 2.167553
 [41] 2.157000 2.145630 2.133397 2.120260 2.106180 2.091118 2.075044 2.057929
 [49] 2.039751 2.020499 2.000167 1.978762 1.956302 1.932817 1.908351 1.882963
 [57] 1.856728 1.829735 1.802088 1.773906 1.745321 1.716476 1.687524 1.658624
 [65] 1.629939 1.601632 1.573863 1.546786 1.520544 1.495269 1.471076 1.448062
 [73] 1.426307 1.405869 1.386786 1.369077 1.352742 1.337762 1.324104 1.311721
 [81] 1.300556 1.290542 1.281608 1.273675 1.266665 1.260500 1.255100 1.250392
 [89] 1.246302 1.242763 1.239712 1.237091 1.234848 1.232933 1.231305 1.229923
 [97] 1.228755 1.227770 1.226941 1.226102</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(RidgeCV<span class="sc">$</span>cvm) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.226102</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>RidgeCV<span class="sc">$</span>lambda.min</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1019493</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>RidgePredictTest<span class="ot">&lt;-</span><span class="fu">predict</span>(RidgeCV,<span class="at">s=</span>RidgeCV<span class="sc">$</span>lambda.min,<span class="at">newx=</span><span class="fu">as.matrix</span>(predictors.test))</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>MSPE_Ridge_test<span class="ot">&lt;-</span><span class="fu">mean</span>((RidgePredictTest<span class="sc">-</span>y.test)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>MSPE_linear<span class="ot">&lt;-</span>MSPE_Ridge_test</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(MSPE_linear)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.243111</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR2)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(splines)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>linearmodel<span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> fage<span class="sc">+</span>mage<span class="sc">+</span>weeks<span class="sc">+</span>visits<span class="sc">+</span>gained, <span class="at">data =</span> train_data)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(linearmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ fage + mage + weeks + visits + gained, 
    data = train_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.5095 -0.7245 -0.0344  0.7819  4.3711 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -7.069515   0.581129 -12.165  &lt; 2e-16 ***
fage         0.014971   0.009724   1.540  0.12413    
mage         0.010142   0.009666   1.049  0.29445    
weeks        0.339776   0.014522  23.397  &lt; 2e-16 ***
visits       0.012027   0.010808   1.113  0.26622    
gained       0.008512   0.003048   2.793  0.00537 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.102 on 692 degrees of freedom
Multiple R-squared:  0.4722,    Adjusted R-squared:  0.4683 
F-statistic: 123.8 on 5 and 692 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#test on single variable (weeks)</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>model_high <span class="ot">=</span> <span class="fu">gam</span>(weight <span class="sc">~</span> <span class="fu">s</span>(weeks, <span class="at">bs =</span> <span class="st">"cr"</span>, <span class="at">sp=</span><span class="dv">300</span>), <span class="at">data =</span> train_data)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>model_high</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
weight ~ s(weeks, bs = "cr", sp = 300)

Estimated degrees of freedom:
3.96  total = 4.96 

GCV score: 1.13054     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>model_low <span class="ot">=</span> <span class="fu">gam</span>(weight <span class="sc">~</span> <span class="fu">s</span>(weeks, <span class="at">bs =</span> <span class="st">"cr"</span>, <span class="at">sp=</span>.<span class="dv">00000000000001</span>), <span class="at">data =</span> train_data)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>model_OK <span class="ot">=</span> <span class="fu">gam</span>(weight <span class="sc">~</span> <span class="fu">s</span>(weeks, <span class="at">bs =</span> <span class="st">"cr"</span>), <span class="at">data =</span> train_data, <span class="at">method =</span> <span class="st">"REML"</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>model_OK<span class="sc">$</span>sp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>s(weeks) 
 118.113 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_high, <span class="at">shade =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-1-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_low, <span class="at">shade =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-1-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_OK, <span class="at">shade =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-1-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>model_lm2 <span class="ot">=</span> <span class="fu">gam</span>(weight <span class="sc">~</span> <span class="fu">s</span>(fage)<span class="sc">+</span><span class="fu">s</span>(mage)<span class="sc">+</span><span class="fu">s</span>(weeks)<span class="sc">+</span><span class="fu">s</span>(visits)<span class="sc">+</span><span class="fu">s</span>(gained), <span class="at">data =</span> train_data, <span class="at">method=</span><span class="st">"REML"</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>model_lm2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
weight ~ s(fage) + s(mage) + s(weeks) + s(visits) + s(gained)

Estimated degrees of freedom:
1.00 1.00 4.84 4.27 1.00  total = 13.11 

REML score: 1033.711     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#removing 3 variables with 1 estimated degrees of freedom- fage, mage, gained for linear modeling to be included as Parametric Coefficients</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>gam_model <span class="ot">=</span> <span class="fu">gam</span>(weight <span class="sc">~</span> fage<span class="sc">+</span> mage <span class="sc">+</span><span class="fu">s</span>(weeks)<span class="sc">+</span><span class="fu">s</span>(visits)<span class="sc">+</span> gained, <span class="at">data =</span> train_data, <span class="at">method=</span><span class="st">"REML"</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co"># we keep seeks and visits within the smoothing function</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gam_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
weight ~ fage + mage + s(weeks) + s(visits) + gained

Parametric coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 6.239524   0.224609  27.780   &lt;2e-16 ***
fage        0.017583   0.009178   1.916   0.0558 .  
mage        0.004097   0.009170   0.447   0.6552    
gained      0.006518   0.002891   2.254   0.0245 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Approximate significance of smooth terms:
            edf Ref.df       F p-value    
s(weeks)  4.840  5.882 108.171  &lt;2e-16 ***
s(visits) 4.266  5.260   3.147  0.0072 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

R-sq.(adj) =   0.53   Deviance explained = 53.8%
-REML =   1040  Scale est. = 1.0728    n = 698</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gam_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
weight ~ fage + mage + s(weeks) + s(visits) + gained

Estimated degrees of freedom:
4.84 4.27  total = 13.11 

REML score: 1039.988     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#predict() function to predict the weight variable in the test_data dataset using gam_model</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>predicted_weights_gam<span class="ot">&lt;-</span><span class="fu">predict</span>(gam_model, test_data)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>predicted_weights_gam</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6         7         8 
7.5440143 7.6155990 7.3184928 6.7480857 7.2873284 7.2346419 7.3264115 7.4400624 
        9        10        11        12        13        14        15        16 
7.4191122 7.2572187 7.6323616 7.3330885 6.8151949 6.4087828 7.5764664 7.1392739 
       17        18        19        20        21        22        23        24 
7.6417958 6.6162236 7.4267417 7.0481855 6.9665285 7.3591771 7.4691362 7.7016345 
       25        26        27        28        29        30        31        32 
4.7716174 6.2374892 6.4370486 7.1600173 7.4816381 6.6762571 7.0920163 7.5957261 
       33        34        35        36        37        38        39        40 
7.6500289 7.2368716 7.2778003 6.4421988 7.8677313 7.5156636 7.2150568 7.4364665 
       41        42        43        44        45        46        47        48 
7.5463307 7.7936875 7.5731755 7.4599415 7.7094360 6.8866470 4.0640961 5.1488183 
       49        50        51        52        53        54        55        56 
4.7521994 6.4896856 7.3129328 7.2436766 7.3728091 7.5398262 7.7756135 7.8475995 
       57        58        59        60        61        62        63        64 
7.2142188 7.5645070 7.8227471 6.7429963 7.6941072 5.4857331 7.1215962 7.3240152 
       65        66        67        68        69        70        71        72 
7.4491908 7.5171013 6.9948451 7.5434989 6.7571388 7.4807169 7.3037202 7.8869041 
       73        74        75        76        77        78        79        80 
7.3133586 7.4561916 7.4439332 7.6392534 3.5263701 6.9291990 7.6805314 7.6060285 
       81        82        83        84        85        86        87        88 
7.1283890 6.9274786 7.5438017 7.0712182 7.7471023 7.3835817 6.8214785 7.4546484 
       89        90        91        92        93        94        95        96 
6.9663542 6.6580606 6.0368913 4.4262349 7.2402510 7.3838488 7.5127323 7.0128868 
       97        98        99       100       101       102       103       104 
7.5711347 7.6680323 7.2419245 7.4763764 7.5167792 7.5542714 7.7520003 7.1155118 
      105       106       107       108       109       110       111       112 
7.3762719 7.8796125 6.4848220 5.4646193 6.9922171 7.3181983 7.6792970 7.6596343 
      113       114       115       116       117       118       119       120 
7.1570867 7.0822144 6.8098121 7.5607624 7.4828808 7.1111190 7.5977473 7.4705533 
      121       122       123       124       125       126       127       128 
7.2131297 7.6726537 7.3238965 7.3827486 7.8291797 7.5169371 6.7110227 7.6866651 
      129       130       131       132       133       134       135       136 
7.5163572 7.2321660 7.5960558 7.9344897 7.5031413 5.8996759 5.3323819 7.2566554 
      137       138       139       140       141       142       143       144 
7.2507276 7.5963284 7.7625272 7.3309274 7.8299045 7.8115650 7.9553918 7.5393980 
      145       146       147       148       149       150       151       152 
7.7588611 7.6988978 7.6689191 7.1095694 7.6055998 7.6987119 7.8055521 7.7299393 
      153       154       155       156       157       158       159       160 
7.7626862 3.3895481 4.7284018 7.2768302 7.6572598 6.6891232 7.8045656 7.7869562 
      161       162       163       164       165       166       167       168 
7.7035024 7.5338437 7.2817030 7.4325578 7.4501232 7.5736891 7.4252708 5.8807086 
      169       170       171       172       173       174       175       176 
7.5741059 7.7020448 7.6434854 7.8025741 7.7649163 6.6301564 7.3060323 7.8390000 
      177       178       179       180       181       182       183       184 
7.4431724 7.2402436 7.2748049 2.0849653 6.0364294 7.4301295 7.7973661 7.4395004 
      185       186       187       188       189       190       191       192 
7.3429879 7.0986167 7.6320544 7.2786515 8.0366322 6.9036750 6.8358747 7.1289917 
      193       194       195       196       197       198       199       200 
7.6751013 7.5286680 5.8834761 1.3743371 5.4119876 7.4883420 7.6012376 7.8642530 
      201       202       203       204       205       206       207       208 
7.0936368 7.9524843 7.5239341 7.3165124 7.3716821 7.9585644 7.4498932 7.8921570 
      209       210       211       212       213       214       215       216 
7.0801190 7.1477203 7.3645555 7.0513170 7.3233535 7.0603672 7.6749737 7.9000351 
      217       218       219       220       221       222       223       224 
7.6316057 7.8586614 6.6217218 6.4321333 7.5177545 7.7396757 7.8179138 7.3672920 
      225       226       227       228       229       230       231       232 
7.8394464 7.0716765 7.8434695 7.3385135 7.1846978 7.5058385 7.7429710 7.5713483 
      233       234       235       236       237       238       239       240 
4.8626006 2.5690702 5.1472270 7.7633316 7.5577195 7.3583538 7.2965080 7.3509348 
      241       242       243       244       245       246       247       248 
6.8302194 6.9820744 7.8121370 7.7040234 7.5225530 7.4657150 8.1316122 6.6657372 
      249       250       251       252       253       254       255       256 
6.6077276 7.8288977 7.3146296 7.6167472 6.9156129 7.8301568 7.7241932 7.0987746 
      257       258       259       260       261       262       263       264 
7.3368817 7.8314763 6.9034123 7.6871540 7.2452730 7.7113656 7.9183015 6.4001030 
      265       266       267       268       269       270       271       272 
7.7898679 7.6887591 7.8323035 7.3458036 7.7282903 7.0808267 7.4919799 6.0362292 
      273       274       275       276       277       278       279       280 
6.5272656 6.3875492 2.6880641 7.5018586 7.3703922 7.1498256 7.7115137 7.3911629 
      281       282       283       284       285       286       287       288 
3.9323484 7.8624715 7.8451254 7.1220160 7.7568753 7.9386399 6.9169760 7.5880071 
      289       290       291       292       293       294       295       296 
7.9448959 7.9989870 0.5032178 4.3780738 7.9689652 7.3811901 7.4787576 8.0839058 
      297       298       299       300       301 
6.3759338 6.3467639 7.4969858 7.7118394 4.3020275 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>MSPE_gam<span class="ot">&lt;-</span><span class="fu">mean</span>((predicted_weights_gam<span class="sc">-</span>y.test)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(MSPE_gam)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.159199</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Please provide your code for Task 5 in this code chunk</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="co">#linear model</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>linearmodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ fage + mage + weeks + visits + gained, 
    data = train_data)

Coefficients:
(Intercept)         fage         mage        weeks       visits       gained  
  -7.069515     0.014971     0.010142     0.339776     0.012027     0.008512  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>MSPE_linear</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.243111</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(linearmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-1-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-1-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-1-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-1-9.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>gam_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
weight ~ fage + mage + s(weeks) + s(visits) + gained

Estimated degrees of freedom:
4.84 4.27  total = 13.11 

REML score: 1039.988     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>MSPE_gam</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.159199</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gam_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-1-10.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-1-11.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co">#both the gam model and linear model are very close - 0.083 difference, but the MSPE gam does have the lower Mean Squared prediction error (MSPE), and therefore is the more superior of the models to use in this situation for testing.  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>